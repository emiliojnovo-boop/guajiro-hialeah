<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guajiro de Hialeah</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #fef3c7; color: #333; }
    
    .container { max-width: 800px; margin: 0 auto; padding: 20px; }
    
    .header { background: #92400e; padding: 30px 20px; border-bottom: 4px solid #fbbf24; margin-bottom: 20px; border-radius: 10px; }
    .header-content { display: flex; justify-content: space-between; align-items: flex-start; }
    .title-section { display: flex; align-items: center; gap: 15px; }
    .emoji { font-size: 40px; }
    .title-text h1 { font-size: 28px; color: #fbbf24; margin: 0; }
    .title-text p { color: #fcd34d; font-size: 12px; font-weight: bold; margin: 0; }
    .tagline { color: #fde68a; font-size: 12px; font-style: italic; margin-top: 10px; }
    
    .info-button { background: #fbbf24; border: none; padding: 10px 15px; border-radius: 50%; font-size: 18px; cursor: pointer; }
    .info-button:hover { background: #fcd34d; }
    
    .card { background: white; border: 2px solid #fbbf24; border-radius: 10px; padding: 15px; margin-bottom: 15px; }
    .card-title { font-size: 18px; font-weight: bold; margin-bottom: 10px; }
    
    .input-group { display: flex; flex-direction: column; gap: 10px; }
    textarea { border: 2px solid #fbbf24; border-radius: 8px; padding: 10px; height: 150px; font-family: monospace; resize: vertical; }
    textarea:focus { outline: none; border-color: #d97706; }
    
    button { background: #d97706; color: white; border: none; padding: 15px; border-radius: 8px; font-weight: bold; font-size: 14px; cursor: pointer; margin-top: 10px; }
    button:hover { background: #b85d00; }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    
    .error-box { background: #fee2e2; color: #dc2626; padding: 10px; border-radius: 8px; margin-top: 10px; }
    .success-box { background: #dcfce7; color: #166534; padding: 10px; border-radius: 8px; margin-top: 10px; }
    
    .result-container { background: #fef3c7; border: 2px solid #fbbf24; border-radius: 8px; padding: 15px; height: 300px; overflow-y: auto; margin-top: 10px; position: relative; }
    .result-container p { color: #d97706; text-align: center; margin-top: 100px; }
    .result-text { line-height: 1.6; white-space: pre-wrap; }
    
    .result-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .copy-button { background: #fef3c7; color: #333; border: 1px solid #fbbf24; padding: 8px 12px; font-size: 12px; }
    .copy-button:hover { background: #fde68a; }
    
    .loading { text-align: center; color: #d97706; font-size: 14px; }
    .spinner { display: inline-block; width: 20px; height: 20px; border: 3px solid #fef3c7; border-top-color: #d97706; border-radius: 50%; animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 1000; align-items: center; justify-content: center; }
    .modal.open { display: flex; }
    .modal-content { background: #fef3c7; border-radius: 10px; padding: 30px; max-width: 500px; max-height: 80vh; overflow-y: auto; }
    .modal-title { font-size: 22px; font-weight: bold; margin-bottom: 15px; }
    .modal-text { margin-bottom: 15px; line-height: 1.6; }
    .modal-close { background: #92400e; color: white; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; }
    .modal-close:hover { background: #7a3008; }
    
    .copied-badge { position: absolute; top: 50%; right: 20px; background: #10b981; color: white; padding: 10px 15px; border-radius: 8px; font-weight: bold; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="header-content">
        <div class="title-section">
          <div class="emoji">üå¥</div>
          <div class="title-text">
            <h1>Guajiro de Hialeah</h1>
            <p>EST 1936</p>
          </div>
        </div>
        <button class="info-button" onclick="openAbout()">‚ÑπÔ∏è</button>
      </div>
      <div class="tagline">Un o√≠do artificial inteligente que capta la magia</div>
    </div>

    <div id="aboutModal" class="modal">
      <div class="modal-content">
        <h2 class="modal-title">üå¥ Acerca de</h2>
        <div class="modal-text">
          <strong>Guajiro de Hialeah</strong> preserva la d√©cima espinela cubana.
        </div>
        <h3 style="font-size: 16px; font-weight: bold; margin-top: 15px;">En Honor a Calixto Gonz√°lez</h3>
        <div class="modal-text">
          Calixto Gonz√°lez dedic√≥ su vida a la d√©cima cubana. Esta app contin√∫a su legado.
        </div>
        <div class="modal-text">
          <strong>Creada por:</strong> Emilio Jos√© Novo<br>
          <strong>Versi√≥n:</strong> 2.0 Pro (Perplexity AI)
        </div>
        <button class="modal-close" onclick="closeAbout()">Cerrar</button>
      </div>
    </div>

    <div class="card">
      <div class="card-title">üìÑ Entrada</div>
      <div class="input-group">
        <textarea id="inputText" placeholder="Pega la transcripci√≥n..."></textarea>
        <button id="transcribeBtn" onclick="transcribe()" style="margin-top: 10px;">Organizar en D√©cimas</button>
        <div id="error" class="error-box" style="display: none;"></div>
      </div>
    </div>

    <div class="card">
      <div class="result-header">
        <div class="card-title">Resultado</div>
        <button id="copyBtn" class="copy-button" onclick="copyToClipboard()" style="display: none;">üìã Copiar</button>
      </div>
      <div class="result-container" id="resultContainer">
        <p>üéµ Las d√©cimas aparecer√°n aqu√≠</p>
      </div>
      <div id="copiedMsg" class="copied-badge" style="display: none;">¬°Copiado!</div>
    </div>
  </div>

  <script>
    let currentResult = '';

    async function transcribe() {
      const input = document.getElementById('inputText').value.trim();
      const errorEl = document.getElementById('error');
      const resultContainer = document.getElementById('resultContainer');
      const transcribeBtn = document.getElementById('transcribeBtn');

      if (!input) {
        errorEl.textContent = 'Por favor, ingresa una transcripci√≥n';
        errorEl.style.display = 'block';
        return;
      }

      errorEl.style.display = 'none';
      resultContainer.innerHTML = '<div class="loading"><div class="spinner"></div> Procesando...</div>';
      transcribeBtn.disabled = true;

      try {
        const response = await fetch('/.netlify/functions/transcribe', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ text: input })
        });

        const data = await response.json();

        if (!data.success) {
          throw new Error(data.error || 'Error desconocido');
        }

        currentResult = data.result;
        resultContainer.innerHTML = `<div class="result-text">${data.result.replace(/</g, '&lt;').replace(/>/g, '&gt;')}</div>`;
        document.getElementById('copyBtn').style.display = 'inline-block';

      } catch (err) {
        errorEl.textContent = err.message || 'Error al transcribir';
        errorEl.style.display = 'block';
        resultContainer.innerHTML = '<p>üéµ Las d√©cimas aparecer√°n aqu√≠</p>';
      } finally {
        transcribeBtn.disabled = false;
      }
    }

    function copyToClipboard() {
      navigator.clipboard.writeText(currentResult).then(() => {
        const copiedMsg = document.getElementById('copiedMsg');
        copiedMsg.style.display = 'block';
        setTimeout(() => { copiedMsg.style.display = 'none'; }, 2000);
      }).catch(err => {
        alert('Error al copiar: ' + err.message);
      });
    }

    function openAbout() {
      document.getElementById('aboutModal').classList.add('open');
    }

    function closeAbout() {
      document.getElementById('aboutModal').classList.remove('open');
    }

    document.getElementById('aboutModal').addEventListener('click', (e) => {
      if (e.target.id === 'aboutModal') closeAbout();
    });
  </script>
</body>
</html>
